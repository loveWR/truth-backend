{extend name="application/common/view/list.html" /} {block name="header"}
<script src="__ADMIN__/js/webuploader/webuploader.js"></script>
<link href="__ADMIN__/ACE/components/jquery-colorbox/colorbox.min.css" rel="stylesheet" />
<script src="__ADMIN__/ACE/components/jquery-colorbox/jquery.colorbox.js"></script>
<script src="__ADMIN__/js/attfile/imageList.js"></script>
<script src="__ADMIN__/js/jQueryRotate.js"></script>
<script src="__ADMIN__/js/Sortable-master/Sortable.js"></script>
<!-- 图片剪切 -->
<link rel="stylesheet" href="__ADMIN__/js/cropper/cropper.css" />
<script src="__ADMIN__/js/cropper/cropper.js"></script>
<script src="__ADMIN__/js/cropper/main.js"></script>
<!-- 附件列表 -->
<link href="__ADMIN__/js/attfile/css/attFileList.css" rel="stylesheet" />
<script src="__ADMIN__/js/attfile/attFileList.js"></script>
<script src="__ADMIN__/js/jquery-validate/jquery.validate.min.js"></script>
<link rel="stylesheet" type="text/css" href="__ADMIN__/ACE/components/mjolnic-bootstrap-colorpicker/dist/css/bootstrap-colorpicker.min.css" />
<script src="__ADMIN__/ACE/components/mjolnic-bootstrap-colorpicker/dist/js/bootstrap-colorpicker.min.js" type="text/javascript" charset="utf-8"></script>
{/block} {block name="main_content"}
<div class="main-content">
	<div class="main-content-inner">
		<div class="page-content">
			<div class="row">
				<div class="col-xs-12">
					<form class="form-horizontal validate" role="form" id="form1" method="post">
						{:token('__token__'.getGUID(), 'sha1')}
						<table cellspacing="1" width="100%" border="0" align="center" class="form-table">
							<tr>
								<td class="title" width="20%" nowrap="nowrap">是否启用水印
								</td>
								<td class="field listradio" width="80%">
									<label>
									
                                                    <input name="water_enable" type="radio" class="ace" {eq name="$sysconfig.water_enable" value="1" } checked="checked" {/eq} value="1">
                                                    <span class="lbl">是</span>
                                        
                                    </label>
									<label>
										
                                                    <input name="water_enable" type="radio" class="ace" {eq name="$sysconfig.water_enable" value="0" } checked="checked" {/eq}  value="0">
                                                    <span class="lbl">否</span>
                                      
                                    </label>

								</td>
							</tr>
							<tr>
								<td class="title" width="15%" nowrap="nowrap">水印类型
								</td>
								<td class="field listradio" width="35%">
									<label>

                                                    <input name="water_type" type="radio" class="ace" {eq name="$sysconfig.water_type" value="1" } checked="checked" {/eq} value="1">
                                                    <span class="lbl">图片水印</span>
                                                </label>
									<label>
                                                    <input name="water_type" type="radio" class="ace" {eq name="$sysconfig.water_type" value="0" } checked="checked" {/eq}  value="0">
                                                    <span class="lbl">文字水印</span>
                                                </label>
								</td>
							</tr>

							<tr class="pic_water">
								<td class="title" width="15%" nowrap="nowrap">水印图片
								</td>
								<td class="field" width="35%">
									<div id="uploader-demo" class="uploader col-sm-9">
										<img src="{$sysconfig.water_file}" alt="" id="img1" width="100" height="100">
										<div class="uploadInfo text-center">
											上传成功
										</div>

										<div id="filePicker1">选择图片</div>
										<input type="hidden" name="water_file" id="water_file" value="{$sysconfig.water_file}" />
									</div>
								</td>
							</tr>
							<tr class="pic_water">
								<td class="title" width="15%" nowrap="nowrap">水印透明度
								</td>
								<td class="field" width="35%">
									<input class="" id="water_alpha" name="water_alpha" type="number" min="0" max="100" placeholder="值范围：0-100" value="{$sysconfig.water_alpha}" />
								</td>
							</tr>

							<tr class="word_water">
								<td class="title" width="15%" nowrap="nowrap">水印文字
								</td>
								<td class="field" width="35%">
									<div class="input-group pull-left">
										<textarea  id="water_text" name="water_text" placeholder="" type="text">{$sysconfig.water_text}</textarea>
									</div>
									 <span class="helping"></span>
								</td>
							</tr>
							<tr class="word_water">
								<td class="title" width="15%" nowrap="nowrap">水印字体文件
								</td>
								<td class="field" width="35%">

									<select name="water_font">
										{volist name="files" id="v"}
										<option value="{$key}" {eq name="$sysconfig['water_font']" value="$key" }selected{/eq}>{$v}</option>
										{/volist}
									</select>

								</td>
							</tr>
							<tr class="word_water">
								<td class="title" width="15%" nowrap="nowrap">水印文字大小
								</td>
								<td class="field" width="35%">
									<div class="input-group pull-left">
										<input class="" id="water_text_size" name="water_text_size" type="number" value="{$sysconfig.water_text_size}" />
									</div>
									 <span class="helping"></span>
								</td>
							</tr>
							<tr class="word_water">
								<td class="title" width="15%" nowrap="nowrap">水印文字颜色
								</td>
								<td class="field" width="35%">
									<div class="input-group pull-left">
										<input id="water_text_color" class="  iColorPicker" name="water_text_color" type="text" value="{$sysconfig.water_text_color}" placeholder="如:#FFFF00" />
									</div>
									<span class="helping"></span>
								</td>
							</tr>
							<tr class="word_water">
								<td class="title" width="15%" nowrap="nowrap">水印文字角度
								</td>
								<td class="field" width="35%">
									<div class="input-group pull-left">
										<input class="" id="water_text_angle" name="water_text_angle" type="number" value="{$sysconfig.water_text_angle}" />
									</div>
									 <span class="helping"></span>
								</td>
							</tr>
							<tr class="word_water">

									<td class="title" width="15%" nowrap="nowrap">水印文字水平X偏移量
									</td>
								<td class="field" width="35%">
									<div class="input-group pull-left">
   										<input class="" id="water_offset_x" name="water_offset_x" type="number" value="{$sysconfig.water_offset_x}" />
   									</div>
   									<span class="helping"></span>
								</td>
							</tr>
							<tr class="word_water">
								<td class="title" width="15%" nowrap="nowrap">水印文字垂直Y偏移量
								</td>
								<td class="field" width="35%">
									<div class="input-group pull-left">
										<input class="" id="water_offset_y" name="water_offset_y" type="number" value="{$sysconfig.water_offset_y}" />
									</div>
									<span class="helping"></span>
								</td>
							</tr>

							<tr>
								<td class="title" width="15%" nowrap="nowrap">水印位置
								</td>
								<td class="field listradio " width="35%">
									<label>
                                                    <input name="water_position" type="radio" class="ace" {eq name="$sysconfig.water_position" value="1" } checked="checked" {/eq} value="1">
                                                    <span class="lbl">左上角</span>
                                                </label>
									<label>
                                                    <input name="water_position" type="radio" class="ace" {eq name="$sysconfig.water_position" value="2" } checked="checked" {/eq}  value="2">
                                                    <span class="lbl">上居中</span>
                                                </label>
									<label>
                                                    <input name="water_position" type="radio" class="ace" {eq name="$sysconfig.water_position" value="3" } checked="checked" {/eq}  value="3">
                                                    <span class="lbl">右上角</span>
                                                </label>
									<br>
									<label>
                                                    <input name="water_position" type="radio" class="ace" {eq name="$sysconfig.water_position" value="4" } checked="checked" {/eq} value="4">
                                                    <span class="lbl">左居中</span>
                                                </label>
									<label>
                                                    <input name="water_position" type="radio" class="ace" {eq name="$sysconfig.water_position" value="5" } checked="checked" {/eq}  value="5">
                                                    <span class="lbl">正居中</span>
                                                </label>
									<label>
                                                    <input name="water_position" type="radio" class="ace" {eq name="$sysconfig.water_position" value="6" 6} checked="checked" {/eq}  value="6">
                                                    <span class="lbl">右居中</span>
                                                </label>
									<br>
									<label>
                                                    <input name="water_position" type="radio" class="ace" {eq name="$sysconfig.water_position" value="7" } checked="checked" {/eq} value="7">
                                                    <span class="lbl">左下角</span>
                                                </label>
									<label>
                                                    <input name="water_position" type="radio" class="ace" {eq name="$sysconfig.water_position" value="8" } checked="checked" {/eq}  value="8">
                                                    <span class="lbl">下居中</span>
                                                </label>
									<label>
                                                    <input name="water_position" type="radio" class="ace" {eq name="$sysconfig.water_position" value="9" } checked="checked" {/eq}  value="9">
                                                    <span class="lbl">右下角</span>
                                                </label>
								</td>
							</tr>

						</table>

					</form>
				</div>
			</div>
		</div>
	</div>
</div>
<div class="text-center buttonArea">
	<button class="fa fa-save green larger fa-lg btn btn-primary" id="submit" type="button">保存配置</button>
	<button class=" red fa-lg fa fa-eye btn btn-primary" id="preview" type="button">预览</button>
</div>

{/block} {block name="footer"}
<script>
	$(function() {
		$('#water_text_color').colorpicker({
			format: "hex"
		});
		if($('input:radio[name="water_type"]:checked').val() == 1) {
			$('.pic_water').show();
			$('.word_water').hide();
			$('#water_alpha').addClass('required');
			$('#water_text_color').removeClass('required');

		} else {
			$('.pic_water').hide();
			$('.word_water').show();
			$('#water_alpha').removeClass('required');
			$('#water_text_color').addClass('required');

		}
		$('input:radio[name="water_type"]').change(function() {
			if($(this).val() == 1) {
				$('.pic_water').show();
				$('.word_water').hide();
				$('#water_alpha').addClass('required');
				$('#water_text_color').removeClass('required');
			} else {
				$('.pic_water').hide();
				$('.word_water').show();
				$('#water_alpha').removeClass('required');
				$('#water_text_color').addClass('required');
			}
		})
		imagePicker('#filePicker1', '#img1', '#water_file', false);
		//imagePicker('#filePicker2','#img2','#web_icon');
		$("#submit").click(function() {
			if(!$('#form1').valid()) {
				try {
					$(".error").eq(0).focus(); //自动定位到第一验证不通过的域  原 focusInvalid: true 在弹窗下不生效（非弹窗测试正常）
				} catch(e) {}
				return false;
			}
			var paramData = $("#form1").formSerialize();
			//console.log(paramData);return;
			$.ajaxSubmitForm({
				url: '{:url("save")}?configgroup=2',
				param: paramData,
				success: function() {
					location.reload();
				}
			});
		});
		$('#preview').click(function() {
			$.modalOpen({
				title: '预览',
				width: "1000px",
				height: "850px",
				url: '{:url("preview")}', //弹出窗口打开的URL
				callBack: function(idx) { //确定按钮提交 修改窗口中的保存
					var win = $.modalWindow(idx); //取得弹出窗口
					win.submitForm(reloadGrid); //提交弹出窗口的保存按钮,并通过回调 reloadGrid 刷新本页面JQgrid
				}
			});
		});

	})
</script>
{/block}